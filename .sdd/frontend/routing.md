# ルーティング設計

## 概要

React Router v7をSPAモードで使用。
シンプルな2ページ構成。

## ルート定義

| パス | コンポーネント | 説明 |
|------|---------------|------|
| `/` | Home | トップページ（ルーム作成・参加） |
| `/room/:roomId` | GameRoom | ゲームルーム |

## ルート詳細

### `/` - Home

ランディングページ兼ルーム管理画面。

**機能**:
- ルーム作成ボタン
- ルームID入力による参加
- ゲーム説明（オプション）

**状態**:
- ルームIDフォーム入力値
- ローディング状態
- エラーメッセージ

### `/room/:roomId` - GameRoom

ゲームプレイ画面。

**パラメータ**:
- `roomId`: ルームの一意識別子（UUID形式）

**機能**:
- ゲームボード表示
- スコア表示
- ルームID共有（コピーボタン）
- 退出ボタン

**状態**:
- WebSocket接続状態
- 盤面状態（Redux）
- プレイヤー情報

## ナビゲーションフロー

```
┌──────────┐     ルーム作成      ┌─────────────────┐
│          │ ──────────────────> │                 │
│   Home   │                     │   GameRoom      │
│   (/)    │ <────────────────── │  (/room/:id)    │
│          │     退出ボタン      │                 │
└──────────┘                     └─────────────────┘
     │                                   │
     │     ルームID入力で参加            │
     └───────────────────────────────────┘
```

## URL設計

### ルームIDの形式

```
/room/a1b2c3d4-e5f6-7890-abcd-ef1234567890
```

- UUID v4形式
- URLセーフな文字のみ
- 大文字小文字を区別しない（正規化して小文字に）

### クエリパラメータ（将来拡張）

```
/room/:roomId?spectate=true  # 観戦モード
/room/:roomId?replay=true    # リプレイモード
```

## エラーハンドリング

### 存在しないルームへのアクセス

```typescript
// GameRoom.tsx
useEffect(() => {
  if (roomNotFound) {
    navigate('/', {
      state: { error: 'ルームが見つかりませんでした' }
    });
  }
}, [roomNotFound]);
```

### 接続エラー

- 自動再接続を試行（最大3回）
- 失敗時はエラーメッセージを表示
- 「ホームに戻る」ボタンを表示

## コード分割（将来検討）

```typescript
// 遅延読み込み（パフォーマンス最適化）
const GameRoom = lazy(() => import('./pages/GameRoom'));
```

現時点ではページ数が少ないため、コード分割は不要。

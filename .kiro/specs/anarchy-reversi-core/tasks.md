# Implementation Plan

- [x] 1. テスト基盤の構築と型定義の拡張
- [x] 1.1 Vitestテスト環境とReact Testing Libraryをセットアップする
  - Vitest、React Testing Library、jsdom環境をインストールする
  - Vitest設定ファイルを作成し、TypeScript・React対応を構成する
  - テスト用セットアップファイルを作成する
  - テスト実行用のnpmスクリプトを追加する

- [x] 1.2 ゲームフェーズ管理に必要な型定義を追加する
  - プレイヤーの色（黒・白）を表す型を定義する
  - ゲームフェーズ（配置中・裏返し中）を表す型を定義する
  - 盤面の位置（行・列）を表す型を定義する
  - ゲーム状態に手番とフェーズのフィールドを追加する
  - _Requirements: 2.1, 2.2, 2.5, 2.6_

- [x] 2. ゲームロジックユーティリティの実装
- [x] 2.1 初期盤面の生成とスコア計算の関数を実装する
  - 中央4マス（d4=白, e4=黒, d5=黒, e5=白）に初期配置した8x8盤面を生成する
  - 盤面上の黒石と白石の数を集計してスコアを返す
  - 入力の盤面を変更しない純粋関数として実装する
  - 各種盤面パターンでスコア計算が正確なことをテストで確認する
  - _Requirements: 1.3, 3.2_

- [x] 2.2 8方向走査による合法手判定を実装する
  - 指定位置が合法手（相手の石を挟める位置）かを判定する関数を作成する
  - 指定プレイヤーの全合法手リストを返す関数を作成する
  - 指定プレイヤーに合法手が1つ以上あるかを判定する関数を作成する
  - 8方向（上下左右＋斜め4方向）を走査して挟み判定を行う
  - 盤面の端・角付近のエッジケースを正しく処理する
  - 初期盤面で黒番の合法手が正しい4箇所であることをテストで確認する
  - _Requirements: 2.3, 2.10_

- [x] 3. ゲーム状態管理の拡張
- [x] 3.1 石の配置アクションとフェーズ遷移を実装する
  - 配置フェーズで合法手の位置に手番の色の石を配置するアクションを追加する
  - 石の配置後に自動的に裏返しフェーズへ遷移させる
  - ゲーム開始時に黒番の配置フェーズから始まる初期状態を設定する
  - 初期盤面を中央4マス配置で生成するように初期化を更新する
  - 配置後にスコアを自動再計算する
  - _Requirements: 1.3, 2.2, 2.5, 2.6_

- [x] 3.2 裏返しアクション・手番終了・自動パス・リセットを実装する
  - 裏返しフェーズで相手の石をクリックして自分の色に変えるアクションを追加する
  - 裏返し回数や対象に制限を設けない（アナーキー要素）
  - 手番終了アクションで手番を交代し配置フェーズに戻す
  - 次の手番に合法手がない場合は自動パスして元の手番に戻す
  - 両プレイヤーとも合法手がない場合はパス1回で停止する（ループ防止）
  - ゲームリセットで盤面・スコア・手番・フェーズをすべて初期状態に戻す
  - すべてのアクション後にスコアを自動再計算する
  - _Requirements: 2.7, 2.8, 2.9, 2.10, 4.1, 4.2, 4.3_

- [x] 4. 表示用UIコンポーネントの実装
- [x] 4.1 (P) 黒石と白石の視覚表示コンポーネントを作成する
  - 黒と白の石を円形で視覚的に区別して表示する
  - セルサイズに合わせた適切なサイズで描画する
  - _Requirements: 1.2_

- [x] 4.2 (P) スコア表示コンポーネントを作成する
  - 黒石と白石の数を常時表示する
  - 黒と白のスコアを色付きで視覚的に区別して表示する
  - 現在の手番をハイライトで示す
  - 盤面の変更に連動して即座に表示を更新する
  - _Requirements: 3.1, 3.2, 3.3_

- [x] 5. インタラクティブUIコンポーネントの実装
- [x] 5.1 フェーズに応じた操作を受け付けるセルコンポーネントを作成する
  - セルの状態（黒石・白石・空）に応じた視覚表示を行う
  - 配置可能な位置に半透明インジケータを表示する
  - 裏返し可能な石にホバー時のフィードバックを表示する
  - 配置フェーズでは合法手の位置のみクリックを受け付ける
  - 裏返しフェーズでは相手の石のみクリックを受け付ける
  - 最低44x44pxのタッチターゲットを確保する
  - 操作時に即座に視覚的フィードバックを提供する
  - _Requirements: 1.2, 1.5, 2.4, 2.5, 2.7, 2.11_

- [x] 5.2 (P) 手番表示と手番終了コントロールのコンポーネントを作成する
  - 現在の手番（黒番・白番）を色付きインジケータで表示する
  - 現在のフェーズ（「配置中」「裏返し中」）をテキストで表示する
  - 裏返しフェーズ中のみ有効な「手番終了」ボタンを提供する
  - 配置フェーズでは「手番終了」ボタンを無効化する
  - _Requirements: 2.1, 2.9_

- [x] 6. レスポンシブ対応の8x8ゲームボードコンポーネントを作成する
  - 8x8のグリッドレイアウトで盤面を構成する
  - 各セルに盤面状態・合法手情報・裏返し可能情報を渡して描画する
  - スマートフォン・タブレット・デスクトップに対応したレスポンシブサイズ調整を行う
  - アスペクト比を維持した盤面表示にする
  - _Requirements: 1.1, 1.4, 1.5_

- [x] 7. GameRoomページに全コンポーネントを統合する
  - ボードプレースホルダーをBoardコンポーネントに置き換える
  - サイドバーにScoreBoardとGameInfoコンポーネントを配置する
  - セルクリックから状態更新までの配置フローを接続する
  - セルクリックから状態更新までの裏返しフローを接続する
  - リセットボタンをゲームリセットアクションに接続する
  - 全要件の動作を統合テストで検証する
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 2.10, 2.11, 3.1, 3.2, 3.3, 4.1, 4.2, 4.3_
